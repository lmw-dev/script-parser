---
description: "A unified and powerful template to create 'Epic Battle Plan' documents. This document serves as the single source of truth for an Epic's technical design, project management, and quality strategy."
alwaysApply: false
---
# Rule: Guide for Writing Epic Battle Plan Documents (v2.1)

When prompted to create a plan for a new Epic, your primary action is to **create a new Markdown file**.
- **File Location**: The new file **must** be saved in the `/docs/battle-plans/` directory.
- **File Naming**: The filename **must** follow the format: `[Epic-ID]-battle-plan-[epic-title-in-kebab-case].md`.
- **Example**: `TOM-326-battle-plan-implement-api-parse-endpoint.md`

The content of this new file must follow the template structure below.
---

# [Epic-ID]: [Epic Title] - å²è¯—ä½œæˆ˜è®¡åˆ’

- **Status**: ğŸ¯ Designing / âœ… Plan Approved

---

## 1. ğŸ¯ æ ¸å¿ƒç›®æ ‡ä¸å†³ç­–æ‘˜è¦ (Objective & Decision Summary)
- **æ‰€å±é¡¹ç›® (Project)**: [Link to the parent Project in Linear]
- **æ ¸å¿ƒä»·å€¼ (Core Value)**: [A single sentence describing the user value and business objective.]
- **å…³é”®å†³ç­– (Core Decisions)**:
    1. **[æŠ€æœ¯é€‰å‹]**: [e.g., Adopting a synchronous API model for the MVP.]
    2. **[æ¶æ„æ¨¡å¼]**: [e.g., Implementing the LLM service using an Adapter Pattern.]
- **é¢„ä¼°æ—¶é—´ (Time Estimate)**: [e.g., ~3 developer-days]

---

## 2. ğŸ—ï¸ æŠ€æœ¯è®¾è®¡ä¸æ¶æ„ (Technical Design & Architecture)
- **æ ¸å¿ƒå·¥ä½œæµ (Core Workflow)**: [Use a Mermaid diagram to visualize the end-to-end data flow and component interaction.]
- **API å¥‘çº¦ (API Contract)**: [Define the API endpoints, request/response schemas using code blocks.]
- **æ•°æ®æ¨¡å‹ (Data Models)**: [Define the core data structures and types.]

### 2.1 å…³é”®æŠ€æœ¯æ–¹æ¡ˆ (Key Technical Solutions)
*[åœ¨æ­¤å¤„è¯¦ç»†æè¿°æ ¸å¿ƒç®—æ³•ã€å…³é”®å‡½æ•°çš„ä¼ªä»£ç æˆ–å…·ä½“çš„å®ç°æ€è·¯ã€‚è¿™éƒ¨åˆ†å†…å®¹æ˜¯AIæ‰§è¡Œå…·ä½“å­ä»»åŠ¡æ—¶çš„é‡è¦å‚è€ƒã€‚]*
**ç¤ºä¾‹:**
> #### **æŠ–éŸ³URLè§£æå™¨ (`DouyinParser`)**
> ```python
> class DouyinParser:
>     def parse_share_url(self, share_text: str) -> VideoInfo:
>         # 1. Regex to find URL in text
>         # 2. Follow redirects to get video_id
>         # 3. Scrape page HTML for window._ROUTER_DATA
>         # 4. Parse JSON and extract no-watermark URL
>         # ...
> ```

---

## 3. ğŸš€ ä½œæˆ˜åºåˆ— (Implementation Sequence)
*This section lists the atomic, ordered sub-tasks (Issues) required to complete the Epic.*

- [ ] **1. [å­ä»»åŠ¡æ ‡é¢˜]**: [ä¸€å¥è¯æè¿°æ­¤å­ä»»åŠ¡çš„ç›®æ ‡]
- [ ] **2. [å­ä»»åŠ¡æ ‡é¢˜]**: [ä¸€å¥è¯æè¿°æ­¤å­ä»»åŠ¡çš„ç›®æ ‡]
- [ ] **3. [å­ä»»åŠ¡æ ‡é¢˜]**: [ä¸€å¥è¯æè¿°æ­¤å­ä»»åŠ¡çš„ç›®æ ‡]

---

## 4. ğŸ§ª è´¨é‡ä¸æµ‹è¯•ç­–ç•¥ (Quality & Testing Strategy)
- **ä¸»è¦æµ‹è¯•å±‚çº§**: [æ˜ç¡®æœ¬æ¬¡Epicå¼€å‘å°†é‡ç‚¹è¦†ç›–çš„æµ‹è¯•ç±»å‹: Unit, Component, Integration]
- **å…³é”®æµ‹è¯•åœºæ™¯**: [åˆ—å‡ºå¿…é¡»è¦†ç›–çš„ã€æœ€é‡è¦çš„å‡ ä¸ªç«¯åˆ°ç«¯æµ‹è¯•åœºæ™¯]
- **æ€§èƒ½è¦æ±‚ (If any)**: [e.g., The p99 latency for the `/api/parse` endpoint must be under 50 seconds for a 1-minute video.]

---

## 5. âœ… éªŒæ”¶æ ‡å‡† (Acceptance Criteria)
*A checklist of conditions that must be met for the entire Epic to be considered "Done".*
- [ ] [ç«¯åˆ°ç«¯åŠŸèƒ½éªŒæ”¶æ ‡å‡† 1]
- [ ] [æ€§èƒ½éªŒæ”¶æ ‡å‡† 2]
- [ ] [é”™è¯¯å¤„ç†éªŒæ”¶æ ‡å‡† 3]