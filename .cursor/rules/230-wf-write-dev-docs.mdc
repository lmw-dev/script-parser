---
description: "A unified and powerful template to create 'Epic Battle Plan' documents V2.1, incorporating Spec-Driven Development principles. This document serves as the single source of truth for an Epic's specification (What/Why) and technical plan (How)." 
alwaysApply: false
---
# Rule: Guide for Writing Epic Battle Plan Documents (v2.1 - SDD Enhanced) 

When prompted to create a plan for a new Epic, your primary action is to **create a new Markdown file**.
- **File Location**: The new file **must** be saved in the `/docs/battle-plans/` directory.
- **File Naming**: The filename **must** follow the format: `[Epic-ID]-battle-plan-[epic-title-in-kebab-case].md`.
- **Example**: `TOM-326-battle-plan-implement-api-parse-endpoint.md`

The content of this new file must follow the **two-part structure** outlined below, emphasizing the separation between **Specification (What/Why)** and **Technical Plan (How)**.

---
# [Epic-ID]: [Epic Title] - å²è¯—ä½œæˆ˜è®¡åˆ’ V2.1

- **Status**: â“ Specifying / ğŸ¯ Designing / âœ… Plan Approved

---

**Part 1: ğŸ“œ è§„æ ¼ (Specification - WHAT/WHY)**
*This part focuses SOLELY on the business requirements, user value, and functional scope. **DO NOT include implementation details (HOW) here.** It serves as the primary input for the Technical Plan.*

## 1. ğŸ¯ æ ¸å¿ƒç›®æ ‡ä¸ä»·å€¼ (Objective & Value)
- **æ‰€å±é¡¹ç›® (Project)**: [Link to the parent Project in Linear]
- **æ ¸å¿ƒä»·å€¼ (Core Value)**: [A single sentence describing the user value and business objective this Epic delivers.]
- **ç”¨æˆ·æ•…äº‹ (User Story / Scenario)**: [Describe the primary scenario(s) this Epic enables from the user's perspective.]

## 2. ğŸ—ºï¸ æ ¸å¿ƒåŠŸèƒ½ä¸èŒƒå›´ (Core Features & Scope)
- **æ ¸å¿ƒåŠŸèƒ½ (Features)**: [Use a checklist to list the specific functionalities included in this Epic.]
    - [ ] Feature 1
    - [ ] Feature 2
- **èŒƒå›´è¾¹ç•Œ (Out of Scope)**: [Explicitly list functionalities or aspects NOT included in this Epic.]
    - [ ] Excluded Feature A
    - [ ] Excluded Feature B

## 3. âœ… éªŒæ”¶æ ‡å‡† (Acceptance Criteria)
*A checklist of observable conditions that must be met for the user-facing functionality to be considered "Done". Focus on *what* the system should do, not *how*.*
- [ ] [Functional Acceptance Criterion 1 related to Feature 1]
- [ ] [Functional Acceptance Criterion 2 related to Feature 2]
- [ ] [Non-Functional Requirement Criterion (e.g., performance target from user perspective)]

## 4. â“ å¾…æ¾„æ¸…ç‚¹ (Needs Clarification) 
***THIS SECTION IS MANDATORY.** List all ambiguities, assumptions, or open questions identified during the specification phase that need clarification before proceeding to the technical plan. Use `[CLARIFIED on YYYY-MM-DD: Answer]` format once resolved.*
- [ ] **[Question 1]**: [e.g., What should happen if the user uploads a file larger than 100MB?] - *[CLARIFIED on 2025-10-21: Show an error message and reject the upload.]*
- [ ] **[Assumption 1]**: [e.g., Assuming the external API has a rate limit of X requests/minute.]

---

**Part 2: ğŸ› ï¸ æŠ€æœ¯è®¡åˆ’ (Technical Plan - HOW)**
*This part details the technical implementation strategy based *strictly* on the Specification defined above.*

## 5. ğŸ§­ å…³é”®å†³ç­–ä¸çº¦æŸ (Core Decisions & Constraints)
- **å…³é”®æŠ€æœ¯å†³ç­– (Core Technical Decisions)**:
    1. **[æŠ€æœ¯é€‰å‹]**: [e.g., Using Next.js App Router, Zustand for state management.]
    2. **[æ¶æ„æ¨¡å¼]**: [e.g., Implementing the processing logic via a serverless function.]
- **çº¦æŸä¸åŸåˆ™ (Constraints & Principles)**: [Reference relevant Constitution rules (@rules/constitution.mdc) or specific project constraints. e.g., Must adhere to offline-first principle.]

## 6. ğŸ—ï¸ æŠ€æœ¯è®¾è®¡ä¸æ¶æ„ (Technical Design & Architecture)
- **æ ¸å¿ƒå·¥ä½œæµ (Core Workflow)**: [Use a Mermaid diagram to visualize the end-to-end data flow and component interaction.]
- **API å¥‘çº¦ (API Contract)**: [Define the API endpoints, request/response schemas using code blocks.]
- **æ•°æ®æ¨¡å‹ (Data Models)**: [Define the core data structures and types.]

### 6.1 å…³é”®æŠ€æœ¯æ–¹æ¡ˆ (Key Technical Solutions)
*[Provide detailed pseudo-code, algorithms, or specific implementation approaches for complex parts, referencing the Specification section (e.g., "To meet AC 1.1...").]*
**ç¤ºä¾‹:**
> #### **æ¨¡æ‹Ÿè¿›åº¦æ¡ç®—æ³• (Simulated Progress Algorithm)** - *Implements Spec Requirement X.Y*
> - **Total Duration**: 48s
> - **Algorithm**: [Describe the 3-stage non-linear algorithm]
> ```typescript
> function calculateProgress(elapsedTime: number): number {
>   // ... implementation details ...
> }
> ```

---

## 7. ğŸš€ ä½œæˆ˜åºåˆ— (Implementation Sequence)
*This section lists the atomic, ordered sub-tasks (Issues) required to implement the Technical Plan.*
- [ ] **1. [å­ä»»åŠ¡æ ‡é¢˜]**: [ä¸€å¥è¯æè¿°æ­¤å­ä»»åŠ¡çš„ç›®æ ‡, relates to Plan section X.Y]
- [ ] **2. [å­ä»»åŠ¡æ ‡é¢˜]**: [ä¸€å¥è¯æè¿°æ­¤å­ä»»åŠ¡çš„ç›®æ ‡, relates to Plan section A.B]
- [ ] **3. [å­ä»»åŠ¡æ ‡é¢˜]**: [ä¸€å¥è¯æè¿°æ­¤å­ä»»åŠ¡çš„ç›®æ ‡, relates to Plan section C.D]

---

## 8. ğŸ§ª è´¨é‡ä¸æµ‹è¯•ç­–ç•¥ (Quality & Testing Strategy)
- **ä¸»è¦æµ‹è¯•å±‚çº§**: [Identify primary testing levels: Unit, Integration, E2E, based on the Plan.]
- **å…³é”®æµ‹è¯•åœºæ™¯**: [List specific technical test scenarios needed to verify the Plan, linking back to Acceptance Criteria.]
- **æ€§èƒ½è¦æ±‚ (If any)**: [Specify technical performance targets, e.g., API latency p99 < 500ms.]