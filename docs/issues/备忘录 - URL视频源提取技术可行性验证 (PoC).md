---
tags: [memo, poc, technical-validation, architecture, script-parser]
status: done
version: 1.0
creation_date: 2025-09-12
related_docs: "[[技术方案 - 脚本快拆(ScriptParser) MVP V1.7]]"
---

# 备忘录 - URL视频源提取技术可行性验证 (PoC)

> [!tip] 备忘录主旨
> 本备忘录记录了为“脚本快拆”项目进行的核心技术可行性验证（PoC）过程与结论。本次PoC的目标是验证我们能否从抖音等主流社交媒体的分享链接中，稳定地获取到可供后续AI处理的原始视频素材。验证的成功与否，直接关系到我们整个技术方案的基石是否稳固。

## 1. 核心结论 (Executive Summary)

本次PoC取得了圆满成功。我们通过对第三方开源工具 `douyin-mcp-server` 的深度代码分析，成功验证了从抖音分享链接中提取无水印视频下载链接的技术路径是完全可行的。更重要的是，我们发现其内部的文本提取功能，与我们选定的**阿里云通义听悟ASR服务**完全一致，这极大地增强了我们对自身技术选型的信心。最终，我们决定不直接依赖该工具，而是采纳“**重写其核心URL解析逻辑，并为其配备强健的监控告警**”的策略，以实现对核心功能的完全掌控，同时主动管理其内在的脆弱性风险。

## 2. PoC分析过程与关键发现

### 2.1 验证起点
我们的`[[需求分析]]` 明确要求支持通过URL进行视频分析。为了验证这一点的可行性，我们找到了一个名为 `douyin-mcp-server` 的开源项目，并对其进行了测试和代码审查。

### 2.2 关键发现
1.  **URL解析逻辑清晰可行:** 我们深入分析了其 `DouyinProcessor.parse_share_url` 函数。发现其核心原理并非依赖某个不稳定的私有API，而是一个经典的**网页抓取 (Web Scraping)** 流程：通过在视频页面的HTML源码中匹配并解析一个包含页面所有数据的JSON对象 (`window._ROUTER_DATA`)，从而获取到无水印的视频下载链接 (`.replace("playwm", "play")`)。这个逻辑虽然依赖于抖音的前端页面结构，但相对清晰，我们可以完全复刻。

2.  **ASR服务选型验证:** 我们发现，该工具的 `extract_douyin_text` 函数，其内部直接调用了 `dashscope.audio.asr.Transcription.async_call`，这正是**阿里云百炼（通义听悟）的语音转文字API**。这与我们经过详尽分析后在 `[[技术方案]]` 中做出的ASR选型完全一致。这个“英雄所见略同”的发现，极大地增强了我们对自身决策的信心。

## 3. 最终决策与架构影响

基于上述发现，我们做出了一个关键的架构决策：**我们不直接集成 `douyin-mcp-server` 这个第三方工具，而是将其核心逻辑“吸收”进我们自己的体系**。

- **决策:** 重写URL解析的核心代码，并将其作为我们FastAPI“AI协处理器”的一个模块。
- **理由:**
    - **完全掌控:** 摆脱对外部工具的依赖，将核心功能代码置于我们自己的版本控制和质量管理之下。
    - **风险管理:** 虽然我们重写了代码，但我们清醒地认识到其依赖于抖音页面结构的脆弱性。因此，我们决定必须为其配备**结构化日志**和**自动化告警**机制，以便在解析逻辑失效时第一时间获得通知并快速响应。

### 3.1 对“AI协处理器”工作流的固化
本次PoC的成功，使我们得以最终固化我们AI协处理器的内部工作流：
1.  接收前端传递的视频URL。
2.  **[已验证]** 调用我们重写的`douyin_parser`模块，获取视频的真实下载地址。
3.  下载视频文件至临时存储。
4.  将视频文件发送给**阿里云通义听悟ASR服务**获取逐字稿。
5.  将逐字稿发送给**LLM服务适配器**进行三段式分析。
6.  返回最终结果，并清理临时文件。

## 4. VCA总结
本次PoC是一次教科书式的技术侦察。我们不仅成功验证了核心技术路径的可行性，还通过深入的代码分析获得了意外的信心加成，并最终制定了一套既能掌控核心功能、又能主动管理风险的成熟工程策略。这为我们即将开始的开发冲刺扫清了最后一个障碍。