# ğŸš¨ ç´§æ€¥ä¿®å¤æŒ‡å— - E2E è·¯å¾„1 SOCKS é”™è¯¯\n\n**çŠ¶æ€**: âœ… ä»£ç å·²å…¨éƒ¨ä¿®å¤ï¼Œéœ€è¦é‡å¯æœåŠ¡\n\n---\n\n## ğŸ“‹ å·²å®Œæˆçš„ä¿®å¤\n\n### 1ï¸âƒ£ `requirements.txt` å·²æ›´æ–°\n\n```diff\n- httpx[socks]==0.27.0\n+ httpx==0.27.0\n\n- socksio>=1.0.0   (å·²ç§»é™¤)\n- PySocks>=1.7.1  (å·²ç§»é™¤)\n```\n\n**ç†ç”±**: SOCKS æ”¯æŒåŒ…åœ¨æ‚¨çš„è™šæ‹Ÿç¯å¢ƒä¸­æ— æ³•å®‰è£…ã€‚ç”±äºä»£ç å·²ä¿®å¤ä¸ºåªåœ¨è®¾ç½®äº†ä»£ç†æ—¶æ‰ä½¿ç”¨ï¼Œç°åœ¨ä¸éœ€è¦ SOCKS æ”¯æŒã€‚\n\n### 2ï¸âƒ£ `url_parser.py` å·²ä¿®å¤ (ä¸¤å¤„)\n\n**ä¸»è¦ä¿®æ”¹**: æ¡ä»¶æ€§ä¼ é€’ `proxies` å‚æ•°\n\n```python\n# ä¹‹å‰ (ä¼šè§¦å‘SOCKSåŠ è½½):\nproxies = {\"all://\": self.proxy_url} if self.proxy_url else None\nclient = httpx.AsyncClient(proxies=proxies, ...)  # âŒ å³ä½¿ä¸ºNoneä¹Ÿä¼šåŠ è½½SOCKS\n\n# ä¹‹å (åªåœ¨éœ€è¦æ—¶ä¼ é€’):\nclient_kwargs = {...}\nif self.proxy_url:\n    client_kwargs[\"proxies\"] = {\"all://\": self.proxy_url}\nclient = httpx.AsyncClient(**client_kwargs)  # âœ… ä¸ä¼šè§¦å‘SOCKSåŠ è½½\n```\n\n---\n\n## ğŸ”„ é‡å¯ Uvicorn\n\n**æ‚¨éœ€è¦åœ¨è¿è¡Œ uvicorn çš„ç»ˆç«¯ä¸­æ“ä½œ:**\n\n### æ­¥éª¤ 1: åœæ­¢å½“å‰ uvicorn\n\nåœ¨è¿è¡Œ `python -m uvicorn app.main:app --reload --port 8000` çš„ç»ˆç«¯ä¸­:\n\n```\næŒ‰ Ctrl+C åœæ­¢è¿›ç¨‹\n```\n\n### æ­¥éª¤ 2: é‡å¯ uvicorn\n\n```bash\ncd /Users/liumingwei/01-project/12-liumw/14-script-parser/apps/coprocessor\nsource .venv/bin/activate\npython -m uvicorn app.main:app --reload --port 8000\n```\n\n**é¢„æœŸè¾“å‡º**:\n```\nINFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)\n```\n\n---\n\n## âœ… éªŒè¯ä¿®å¤\n\né‡å¯åï¼Œå°è¯• E2E è·¯å¾„1:\n\n1. **æ‰“å¼€æµè§ˆå™¨** â†’ `http://localhost:3000`\n2. **é€‰æ‹©** \"é€šç”¨å™äº‹åˆ†æ\"\n3. **è¾“å…¥** ä»»æ„æœ‰æ•ˆçš„è§†é¢‘URL\n4. **ç‚¹å‡»** \"å¼€å§‹åˆ†æ\"\n\n**é¢„æœŸç»“æœ**:\n- âœ… URL è§£ææˆåŠŸï¼ˆä¸å†æŠ¥ SOCKS é”™è¯¯ï¼‰\n- âœ… å¤„ç†å¼€å§‹\n- âœ… æ˜¾ç¤ºåˆ†æç»“æœ\n\n---\n\n## ğŸ” æ•…éšœæ’æŸ¥\n\nå¦‚æœä»ç„¶å‡ºç° SOCKS é”™è¯¯:\n\n### æ£€æŸ¥1: è™šæ‹Ÿç¯å¢ƒæ˜¯å¦æ¿€æ´»\n\n```bash\n# åº”è¯¥æ˜¾ç¤º (.venv) å‰ç¼€\nwhich python\n# åº”è¯¥æ˜¾ç¤º: /Users/liumingwei/01-project/12-liumw/14-script-parser/apps/coprocessor/.venv/bin/python\n```\n\n### æ£€æŸ¥2: httpx ç‰ˆæœ¬\n\n```bash\npip show httpx | grep Version\n# åº”è¯¥æ˜¾ç¤º: Version: 0.27.0\n```\n\n### æ£€æŸ¥3: ç¼“å­˜é—®é¢˜\n\n```bash\n# æ¸…é™¤ Python ç¼“å­˜\nfind . -type d -name \"__pycache__\" -exec rm -rf {} +\nfind . -type f -name \"*.pyc\" -delete\n\n# é‡æ–°å¯åŠ¨ uvicorn\npython -m uvicorn app.main:app --reload --port 8000\n```\n\n---\n\n## ğŸ“ æŠ€æœ¯è¯´æ˜\n\n### ä¸ºä»€ä¹ˆæ”¹ä¸ºæ ‡å‡† httpx\n\n1. **è™šæ‹Ÿç¯å¢ƒé—®é¢˜**: `socksio` åœ¨æ‚¨çš„ç¯å¢ƒä¸­æ— æ³•å®‰è£…ï¼ˆå¯èƒ½æ˜¯ç³»ç»Ÿä¾èµ–é—®é¢˜ï¼‰\n2. **æ¶æ„ä¿®æ”¹**: ä»£ç å·²ä¼˜åŒ–ä¸ºåªåœ¨éœ€è¦ä»£ç†æ—¶æ‰åŠ è½½ç›¸å…³æ”¯æŒ\n3. **å®‰å…¨æ€§**: æ‚¨å·²é€šè¿‡ WireGuard å…¨å±€VPNé…ç½®äº†ç½‘ç»œï¼Œä¸éœ€è¦åº”ç”¨å±‚ä»£ç†\n\n### ä¿®å¤çš„å…³é”®ç‚¹\n\n```python\n# å…³é”®ä¿®å¤: æ¡ä»¶æ€§åˆå§‹åŒ–\nif self.proxy_url:  # åªæœ‰åœ¨ç¯å¢ƒå˜é‡ä¸­è®¾ç½®äº†ä»£ç†æ‰ä½¿ç”¨\n    client_kwargs[\"proxies\"] = {\"all://\": self.proxy_url}\n```\n\nè¿™æ · httpx å°±ä¸ä¼šå°è¯•åœ¨åˆå§‹åŒ–æ—¶åŠ è½½ SOCKS åº“ï¼Œé™¤éç¡®å®éœ€è¦ä»£ç†ã€‚\n\n---\n\n## ğŸ¯ ä¸‹ä¸€æ­¥\n\né‡å¯å®Œæ¯•åï¼Œç»§ç»­æ‰§è¡Œå‰©ä¸‹çš„ 4 æ¡ E2E æµ‹è¯•è·¯å¾„:\n\n- âœ… E2E è·¯å¾„ 1: V2.0å›å½’ (å·²ä¿®å¤)\n- â³ E2E è·¯å¾„ 2: V3.0æ ¸å¿ƒ\n- â³ E2E è·¯å¾„ 3: æ™ºèƒ½é‡ç½®\n- â³ E2E è·¯å¾„ 4: å¼ºåˆ¶é€‰æ‹©\n- â³ E2E è·¯å¾„ 5: æ•…éšœåˆ‡æ¢\n\nå‚è€ƒ: `docs/testing/E2E-Quick-Reference.md`\n\n---\n\n**ä¿®å¤æ—¶é—´**: 2025-11-12  \n**çŠ¶æ€**: âœ… ä»£ç ä¿®å¤å®Œæˆï¼Œå¾… Uvicorn é‡å¯\n"}